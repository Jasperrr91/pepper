import json
from itertools import chain

dictionary = {}

with open('lfw_gender1.txt') as file1, open('lfw_gender2.txt') as file2:
    for line in chain(file1.readlines(), file2.readlines()):
        for info in json.loads(line):
            if info['gender']:
                dictionary[info['name'].title()] = (info['gender'], float(info['probability']))
            else: dictionary[info['name'].title()] = None

with open('lfw_gender3.txt') as file3:
    for line in file3.readlines():
        info = json.loads(line)
        if info['gender'] != 'unknown':
            dictionary[info['name'].title()] = (info['gender'], float(info['accuracy']) / 100)
        else: dictionary[info['name'].title()] = None


dictionary['Hidetoshi'] = ("male", 1)
dictionary['Hootie'] = ("male", 1)
dictionary['Alecos'] = ("male", 1)
dictionary['Agbani'] = ("female", 1)
dictionary['Satnarine'] = ("male", 1)
dictionary['Shigeo'] = ("male", 1)
dictionary['Gavyn'] = ("male", 1)
dictionary['Sargis'] = ("male", 1)
dictionary['Adoor'] = ("male", 1)
dictionary['Tingfan'] = ("male", 1)
dictionary['Calbert'] = ("male", 1)
dictionary['Arye'] = ("male", 1)
dictionary['Steny'] = ("male", 1)
dictionary['Atiabet'] = ("male", 1)
dictionary['Basdeo'] = ("male", 1)
dictionary['Chante'] = ("female", 1)
dictionary['Arsinee'] = ("female", 1)
dictionary['Tangra'] = ("female", 1)
dictionary['Oracene'] = ("female", 1)
dictionary['Paek'] = ("male", 1)
dictionary['Hermogenes'] = ("male", 1)
dictionary['Saeb'] = ("male", 1)
dictionary['Soenarno'] = ("male", 1)
dictionary['Mitar'] = ("male", 1)
dictionary['Rosny'] = ("male", 1)
dictionary['Kitin'] = ("male", 1)
dictionary['Glafcos'] = ("male", 1)
dictionary['Anzori'] = ("male", 1)
dictionary['Deece'] = ('male', 1)
dictionary['Marricia'] = ('female', 1)
dictionary['Ziwang'] = ('male', 1)
dictionary['Toutai'] = ('male', 1)
dictionary['Lebron'] = ('male', 1)
dictionary['Anfernce'] = ('male', 0)
dictionary['Vagit'] = ('male', 1)
dictionary['Pauley'] = ('female', 1)
dictionary['Surakait'] = ('male', 1)
dictionary['Begum'] = ('female', 1)
dictionary['Muffet'] = ('female', 1)
dictionary['Cabas'] = ('male', 1)
dictionary['Masamori'] = ('male', 1)
dictionary['Ruano'] = ('female', 1)
dictionary['Mstislav'] = ('male', 1)
dictionary['Janela'] = ('female', 1)
dictionary['Platon'] = ('male', 1)
dictionary['Charlize'] = ('female', 1)
dictionary['Dionyssis'] = ('male', 1)
dictionary['Sereyvuth'] = ('male', 1)
dictionary['Harbhajan'] = ('male', 1)
dictionary['Hatsui'] = ('female', 1)
dictionary['Hama'] = ('male', 1)
dictionary['Zavad'] = ('male', 1)
dictionary['Einars'] = ('male', 1)
dictionary['Rafeeuddin'] = ('male', 1)
dictionary['Antwun'] = ('male', 1)
dictionary['Nawabzada'] = ('male', 1)
dictionary['Szu'] = ('female', 1)
dictionary['Condoleezza'] = ('female', 1)
dictionary['Jaymon'] = ('male', 1)
dictionary['Hedayat'] = ('male', 1)
dictionary['Chuanyun'] = ('male', 1)
dictionary['Makiya'] = ('female', 1)
dictionary['Dangelo'] = ('male', 1)
dictionary['Kenenisa'] = ('male', 1)
dictionary['Hisao'] = ('male', 1)
dictionary['Shinzo'] = ('male', 1)
dictionary['Nicholoas'] = ('male', 1)
dictionary['Sharess'] = ('female', 1)
dictionary['Saparmurat'] = ('male', 1)
dictionary['Djabir'] = ('male', 1)
dictionary['Gholamreza'] = ('male', 1)
dictionary['Brawley'] = ('male', 1)
dictionary['Nathirah'] = ('female', 1)
dictionary['Ekke'] = ('male', 1)
dictionary['Taylyn'] = ('male', 1)
dictionary['Muammar'] = ('male', 1)
dictionary['Hutomo'] = ('male', 1)
dictionary['Hestrie'] = ('female', 1)
dictionary['Desmon'] = ('male', 1)
dictionary['Guangdong'] = ('male', 1)
dictionary['Ronde'] = ('male', 1)
dictionary['Hichiro'] = ('male', 1)
dictionary['Pringe'] = ('male', 1)
dictionary['Barzan'] = ('male', 1)
dictionary['Mcguire'] = ('male', 1)
dictionary['Benedita'] = ('female', 1)
dictionary['Leuris'] = ('male', 1)
dictionary['Kweisi'] = ('male', 1)
dictionary['Boutros'] = ('male', 1)
dictionary['Hassanal'] = ('male', 1)
dictionary['Rustu'] = ("male", 1)
dictionary['Marquier'] = ("male", 1)
dictionary['Paradorn'] = ("male", 1)
dictionary['Mohammaed'] = ("male", 1)
dictionary['Chyung'] = ("male", 1)
dictionary['Elijan'] = ("male", 1)
dictionary['Shafal'] = ("male", 1)
dictionary['Joxel'] = ("male", 1)
dictionary['Sedigh'] = ("male", 1)
dictionary['Hrithik'] = ("male", 1)
dictionary['Mitsou'] = ('female', 1)
dictionary['Shamai'] = ('male', 1)
dictionary['Ainsworth'] = ('male', 1)
dictionary['Rohinton'] = ('male', 1)
dictionary['Sureyya'] = ('female', 1)
dictionary['Atal'] = ('male', 1)
dictionary['Yoelbi'] = ('male', 1)
dictionary['Bustam'] = ('male', 1)
dictionary['Fujio'] = ('male', 1)
dictionary['Osrat'] = ('female', 1)
dictionary['Picabo'] = ('female', 1)
dictionary['Compay'] = ('male', 1)
dictionary['Collis'] = ('male', 1)
dictionary['Momcilo'] = ('male', 1)
dictionary['Himmler'] = ('male', 1)
dictionary['Poala'] = ('female', 1)
dictionary['Larenz'] = ('male', 1)
dictionary['Ataollah'] = ('male', 1)
dictionary['T'] = ('male', 1)
dictionary['Fann'] = ('female', 1)
dictionary['Arminio'] = ('male', 1)
dictionary['Hushiar'] = ('male', 1)
dictionary['Tirunesh'] = ('female', 1)
dictionary['Oprah'] = ('female', 1)
dictionary['Heizo'] = ('male', 1)
dictionary['Casy'] = ('female', 1)
dictionary['Beyonce'] = ('female', 1)
dictionary['Crandall'] = ('female', 1)
dictionary['Marsah'] = ('female', 1)
dictionary['Eminem'] = ('male', 1)
dictionary['Raaf'] = ('male', 1)
dictionary['Raag'] = ('male', 1)
dictionary['Nursultan'] = ('male', 1)
dictionary['Takaloo'] = ('male', 1)
dictionary['Sananda'] = ('female', 1)
dictionary['Juljia'] = ('female', 1)
dictionary['Hubie'] = ('male', 1)
dictionary['Dionigi'] = ('male', 1)
dictionary['Darvis'] = ('male', 1)
dictionary['Mother'] = ('female', 1)
dictionary['Makhdoom'] = ('male', 1)
dictionary['Shoshannah'] = ('female', 1)
dictionary['Khum'] = ('male', 1)
dictionary['Natanaela'] = ('female', 1)
dictionary['Nuon'] = ('male', 1)
dictionary['Zumrati'] = ('female', 1)
dictionary['Tocker'] = ('male', 1)
dictionary['Meles'] = ('male', 1)
dictionary['Norodom'] = ('male', 1)
dictionary['Yingfan'] = ('male', 1)
dictionary['Leandrinho'] = ('male', 1)
dictionary['Khatol'] = ('female', 1)
dictionary['Muwafak'] = ('male', 1)
dictionary['Hashan'] = ('male', 1)
dictionary['Lleyton'] = ('male', 1)
dictionary['Momir'] = ('male', 1)
dictionary['Kristanna'] = ('female', 1)
dictionary['Hermando'] = ('male', 1)
dictionary['Strom'] = ('male', 1)
dictionary['Demetrin'] = ('male', 1)
dictionary['Namuddu'] = ('female', 1)
dictionary['Dyab'] = ('male', 1)
dictionary['Mitoji'] = ('male', 1)
dictionary['Ascencion'] = ('male', 1)
dictionary['Jerelle'] = ('female', 1)
dictionary['Jamling'] = ('male', 1)
dictionary['Sahim'] = ('male', 1)
dictionary['Alimzhan'] = ('male', 1)
dictionary['Chadha'] = ('female', 1)
dictionary['Stockard'] = ('female', 1)
dictionary['Artieas'] = ('male', 1)
dictionary['Margerry'] = ('female', 1)
dictionary['Chhouk'] = ('male', 1)
dictionary['Pyar'] = ('male', 1)
dictionary['Halbert'] = ('male', 1)


from pepper.vision.classification.data import load_lfw
import numpy as np
import re

with open('lfw_gender.bin', 'wb') as file:
    for name in load_lfw()[0]:
        first_name = re.findall('([A-Za-z]+)', name.title())[0]
        entry = dictionary[first_name]
        file.write(np.int32(0 if entry[0] == 'male' else 1))
        file.write(np.float32(entry[1]))
